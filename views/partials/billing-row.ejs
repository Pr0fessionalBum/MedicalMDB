<% billings.forEach(bill => { %>
<tr>
  <td><%= bill.patientID?.name || "Unknown" %></td>
  <td>
    <span class="badge badge-<%= bill.status %>">
      <%= bill.status %>
    </span>
  </td>
  <td><%= Number(bill.amount || 0).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) %></td>

  <td><%= bill.createdAt ? new Date(bill.createdAt).toLocaleDateString() : "" %></td>

  <td>
    <a class="btn btn-small btn-ghost" href="/billings/<%= bill._id %>">View</a>
    <% if (billingsCanEdit) { %>
      <a class="btn btn-small" href="/billings/<%= bill._id %>/edit">Edit</a>
    <% } %>
    <form method="POST" action="/billings/<%= bill._id %>/delete" style="display:inline;">
      <button class="btn btn-small" 
              style="background:#dc2626;"
              onclick="return confirm('Delete this billing?')">
        Delete
      </button>
    </form>
  </td>
</tr>
<% }) %>
