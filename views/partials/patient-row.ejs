<% patients.forEach(patient => { %>
<tr>
  <td><strong><%= patient.name %></strong></td>
  <td><%= patient.dob ? new Date(patient.dob).toLocaleDateString() : "N/A" %></td>
  <td><%= patient.age %></td>
  <td><%= patient.gender %></td>
  <td><%= patient.contactInfo?.email || "N/A" %></td>
  <td><%= patient.contactInfo?.phone || "N/A" %></td>
  <td>
    <a href="/patients/<%= patient._id %>" class="btn btn-small">View</a>
    <% if (typeof canEdit === "undefined" || canEdit) { %>
      <a href="/patients/<%= patient._id %>/edit" class="btn btn-small">Edit</a>
      <form method="POST" action="/patients/<%= patient._id %>/delete" style="display:inline;">
        <button class="btn btn-small" style="background:#dc2626;" onclick="return confirm('Delete this patient?')">
          Delete
        </button>
      </form>
    <% } %>
  </td>
</tr>
<% }) %>
